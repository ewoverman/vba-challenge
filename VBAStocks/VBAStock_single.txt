Sub Stocks():

'Lable new columns
Range("I1") = "Ticker"
Range("J1") = "Yearly Change"
Range("K1") = "Percent Change"
Range("L1") = "Total Stock Volume"

'Set initial variable for holding ticker, yearly change, percent change and total volume
Dim Ticker As String
Dim Yearly_Change As Double
Dim Percent_Change As Double
Dim Total_Volume As Double
Dim Yearly_Open As Double
Dim Yearly_Close As Double


'Set inital variable for holding Total Volume total
Total_Volume = 0

'Find last row
lastrow = Cells(Rows.Count, 1).End(xlUp).Row

'Keep track of location of ticker in Summary Table
Dim Summary_Table As Integer
Summary_Table = 2

'Adding the first ticker open price
Yearly_Open = Cells(2, 3).Value


'Loop through all Tickers
For i = 2 To lastrow

    'Check if we are still in the same ticker
    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then

        'Set Ticker name
        Ticker = Cells(i, 1).Value
        
        'Set Yearly Close price
        Yearly_Close = Cells(i, 6).Value
        
        'Add to Total Stock Volume
        Total_Volume = Total_Volume + Cells(i, 7).Value
        
        'Calculate the difference
        Yearly_Change = Yearly_Close - Yearly_Open
        
        'Calculate percentage change
        Percent_Change = (Yearly_Change / Yearly_Open)
        
        'write out percent change
        'FormatPercent( Expression, [NumDigitsAfterDecimal], [IncludeLeadingDigit], [UseParensForNegativeNumbers], [GroupDigits] )
        Range("K" & Summary_Table).Value = FormatPercent(Percent_Change, 2, vbTrue)
                
        'write out yearly change
        Range("J" & Summary_Table).Value = Yearly_Change
            If Yearly_Change < 0 Then
                Range("J" & Summary_Table).Interior.ColorIndex = 3
            ElseIf Yearly_Change > 0 Then
                Range("J" & Summary_Table).Interior.ColorIndex = 4
            End If
        
        'Print ticker sign in the Ticker column
        Range("I" & Summary_Table).Value = Ticker
        
        'Print Total to Summary Table
        Range("L" & Summary_Table).Value = Total_Volume
        
        'Add one to the summary table row
        Summary_Table = Summary_Table + 1
        
        'Reset the Total_Volume
        Total_Volume = 0
        
        'get the next open value now!!!
        Yearly_Open = Cells(i + 1, 3).Value
   
        'If the cell immediately following a row is the same ticker
    Else
        
        'Add to the Total Volume
        Total_Volume = Total_Volume + Cells(i, 7).Value
        
    End If

    Next i
        
       
        
End Sub
